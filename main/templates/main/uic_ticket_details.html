{% load rics %}
{% if ticket.head %}
    <h2 class="govuk-heading-m">Header</h2>
    <dl class="govuk-summary-list">
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Distributing RICS</dt>
            <dd class="govuk-summary-list__value"><code>{{ ticket.head.distributing_rics }}</code></dd>
        </div>
        {% with org=ticket.head.distributor %}
            {% if org %}
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">Distributor</dt>
                    <dd class="govuk-summary-list__value">
                        {% include 'main/rics.html' with org=org %}
                    </dd>
                </div>
            {% endif %}
        {% endwith %}
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Ticket ID</dt>
            <dd class="govuk-summary-list__value"><code>{{ ticket.head.ticket_id }}</code></dd>
        </div>
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Issuing time</dt>
            <dd class="govuk-summary-list__value">{{ ticket.head.issuing_time.as_datetime|date:"F d, Y H:i" }}</dd>
        </div>
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Flags</dt>
            <dd class="govuk-summary-list__value">
                <table class="govuk-table">
                    <tbody class="govuk-table__body">
                    <tr class="govuk-table__row">
                        <td class="govuk-table__cell">International ticket</td>
                        <td class="govuk-table__cell">
                            {% if ticket.head.flags.international_ticket %}
                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                            {% else %}
                                <strong class="govuk-tag govuk-tag--red">No</strong>
                            {% endif %}
                        </td>
                    </tr>
                    <tr class="govuk-table__row">
                        <td class="govuk-table__cell">Edited by agent</td>
                        <td class="govuk-table__cell">
                            {% if ticket.head.flags.edited_by_agent %}
                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                            {% else %}
                                <strong class="govuk-tag govuk-tag--red">No</strong>
                            {% endif %}
                        </td>
                    </tr>
                    <tr class="govuk-table__row">
                        <td class="govuk-table__cell" style="border-bottom: none">Specimen</td>
                        <td class="govuk-table__cell" style="border-bottom: none">
                            {% if ticket.head.flags.specimen %}
                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                            {% else %}
                                <strong class="govuk-tag govuk-tag--red">No</strong>
                            {% endif %}
                        </td>
                    </tr>
                    </tbody>
                </table>
            </dd>
        </div>
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Language</dt>
            <dd class="govuk-summary-list__value"><code>{{ ticket.head.language }}</code></dd>
        </div>
        {% if ticket.head.second_language %}
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Second language</dt>
                <dd class="govuk-summary-list__value"><code>{{ ticket.head.second_language }}</code></dd>
            </div>
        {% endif %}
    </dl>
{% endif %}

{% if ticket.layout %}
    <h2 class="govuk-heading-m">Paper ticket</h2>
    {% if ticket.layout.standard == "RCT2" %}
        <div class="rct2-ticket-container">
            <div class="rct2-ticket">
                <div class="rct2-ticket-inner">
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left:  1ch;width: 5ch;height: 2em;">Datum</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left:  7ch;width: 5ch;height: 2em;">Zeit</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 13ch;width: 3ch;height: 2em;">Von</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 32ch;width: 2ch;height: 2em;">&#x2B95;</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 34ch;width: 4ch;height: 2em;">Nach</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 52ch;width: 5ch;height: 2em;">Datum</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 58ch;width: 5ch;height: 2em;">Zeit</span>
                    <span class="rct2-ticket-fixed-field" style="top: 4em;left: 66ch;width: 5ch;height: 2em;">Kl.</span>

                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left:  1ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left:  1ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left:  7ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left:  7ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left: 13ch;--width: 37ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left: 13ch;--width: 37ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left: 52ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left: 52ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left: 58ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left: 58ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  4em;--left: 66ch;--width:  5ch;--height: 2em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  6em;--left: 66ch;--width:  5ch;--height: 2em;"></div>

                    <div class="rct2-ticket-fixed-area" style="--top:  0em;--left: 52ch;--width: 19ch;--height: 3em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top:  8em;--left:  1ch;--width: 70ch;--height: 4em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top: 12em;--left:  1ch;--width: 49ch;--height: 3em;"></div>
                    <div class="rct2-ticket-fixed-area" style="--top: 13em;--left: 52ch;--width: 19ch;--height: 2em;"></div>

                    {% for field in ticket.layout.fields %}
                        <span class="rct2-ticket-field{% if field.formatting.bold %} rct2-ticket-field-bold{% endif %}{% if field.formatting.italic %} rct2-ticket-field-italic{% endif %}{% if field.formatting.small_font %} rct2-ticket-field-small-font{% endif %}"
                                style="top:{{ field.line }}em;left: {{ field.column }}ch;height: {{ field.height }}em;{% if not field.text|rics_already_newlined %}width: {{ field.width }}ch;{% endif %}">{{ field.text }}</span>
                    {% endfor %}
                </div>
            </div>
        </div>
    {% else %}
        <h2 class="govuk-heading-s">Unknown ticket layout <code>{{ ticket.layout.standard }}</code></h2>
        {% for field in ticket.layout.fields %}
            <div class="govuk-summary-card">
                <div class="govuk-summary-card__title-wrapper">
                    <h2 class="govuk-summary-card__title">Field #{{ forloop.counter }}</h2>
                </div>
                <div class="govuk-summary-card__content">
                    <dl class="govuk-summary-list">
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Line</dt>
                            <dd class="govuk-summary-list__value"><code>{{ field.line }}</code></dd>
                        </div>
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Column</dt>
                            <dd class="govuk-summary-list__value"><code>{{ field.column }}</code></dd>
                        </div>
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Height</dt>
                            <dd class="govuk-summary-list__value"><code>{{ field.height }}</code></dd>
                        </div>
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Width</dt>
                            <dd class="govuk-summary-list__value"><code>{{ field.width }}</code></dd>
                        </div>
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Formatting</dt>
                            <dd class="govuk-summary-list__value">
                                <table class="govuk-table">
                                    <tbody class="govuk-table__body">
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">Bold</td>
                                        <td class="govuk-table__cell">
                                            {% if field.formatting.bold %}
                                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                                            {% else %}
                                                <strong class="govuk-tag govuk-tag--red">No</strong>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">Italic</td>
                                        <td class="govuk-table__cell">
                                            {% if field.formatting.italic %}
                                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                                            {% else %}
                                                <strong class="govuk-tag govuk-tag--red">No</strong>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">Small font</td>
                                        <td class="govuk-table__cell">
                                            {% if field.formatting.small_font %}
                                                <strong class="govuk-tag govuk-tag--green">Yes</strong>
                                            {% else %}
                                                <strong class="govuk-tag govuk-tag--red">No</strong>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </dd>
                        </div>
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Text</dt>
                            <dd class="govuk-summary-list__value">{{ field.text }}</dd>
                        </div>
                    </dl>
                </div>
            </div>
        {% endfor %}
    {% endif %}
{% endif %}

{% if ticket.flex %}
    <h2 class="govuk-heading-m">Flexible data</h2>
    <dl class="govuk-summary-list">
        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Version</dt>
            <dd class="govuk-summary-list__value"><code>{{ ticket.flex.version }}</code></dd>
        </div>
        {% include "main/uic_flex.html" with flex=ticket.flex %}
    </dl>
{% endif %}

{% for record in ticket.other_records %}
    <div class="govuk-summary-card">
        <div class="govuk-summary-card__title-wrapper">
            <h2 class="govuk-summary-card__title">Unknown record <code>{{ record.id }}</code> - version <code>{{ record.version }}</code></h2>
        </div>
        <div class="govuk-summary-card__content">
            <code style="line-break: anywhere">{{ record.data_hex }}</code>
        </div>
    </div>
{% endfor %}